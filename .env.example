# =============================================================================
# Tailscale JIT Access Management: Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# Generate a Flask secret key:
#   python3 -c "import secrets; print(secrets.token_hex(32))"
# =============================================================================

# ---------------------------------------------------------------------------
# REQUIRED: Tailscale OAuth Credentials
# ---------------------------------------------------------------------------
# Create at: https://login.tailscale.com/admin/settings/oauth
# Scopes needed: devices:read, devices:write
TAILSCALE_CLIENT_ID=your-client-id-here
TAILSCALE_CLIENT_SECRET=tskey-client-xxxxx
TAILSCALE_TAILNET=your-tailnet.ts.net

# ---------------------------------------------------------------------------
# REQUIRED: Flask Secret Key
# ---------------------------------------------------------------------------
FLASK_SECRET_KEY=generate-with-python3-c-import-secrets-print-secrets-token-hex-32

# ---------------------------------------------------------------------------
# OPTIONAL: Application Configuration
# ---------------------------------------------------------------------------

# Capability domain: must match your ACL and --accept-app-caps flag
# REQUIRED in practice - the default is a placeholder that will not work
CAP_DOMAIN=yourdomain.com/cap/jit-access

# Database file path (relative or absolute)
# Default: jit_access.db
# DB_PATH=/opt/tailscale-jit-access/jit_access.db

# Access profiles and approval rules are defined in config.py (not here).
# Edit config.py to add profiles or set default approval rules.

# Device cache TTL in seconds (how often to refresh device list)
# Default: 300 (5 minutes)
# DEVICE_CACHE_TTL=300

# OAuth token cache TTL in seconds (tokens last 1 hour)
# Default: 3000 (50 minutes)
# TOKEN_CACHE_TTL=3000

# Allow users to approve their own requests
# Default: false (secure default - set to true only for dev/single-user installs)
# ALLOW_SELF_APPROVE=false

# Default number of approvals required when no profile-specific rule is configured
# Can be overridden per profile in the Admin page (/admin) by users with can_admin_config
# Default: 1
# DEFAULT_REQUIRED_APPROVALS=1

# ---------------------------------------------------------------------------
# OPTIONAL: Audit Log Retention
# ---------------------------------------------------------------------------

# How many days to retain audit_log and user_activity rows (0 = keep forever)
# Pruning runs at startup and on every background worker cycle
# Default: 365
# AUDIT_LOG_RETENTION_DAYS=365

# Number of audit/activity rows to show per page on the /audit and /activity pages
# Minimum 10, maximum 500
# Default: 100
# AUDIT_PAGE_SIZE=100

# ---------------------------------------------------------------------------
# OPTIONAL: Access Grant Expiry
# ---------------------------------------------------------------------------

# How often (seconds) the background worker checks for expired grants and prunes logs
# On each cycle the worker calls the Tailscale API to delete any posture attributes
# whose duration has elapsed, then marks the request 'expired' in the DB
# Default: 60
# EXPIRY_CHECK_INTERVAL=60
